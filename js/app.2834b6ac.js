(function(e){function t(t){for(var o,s,l=t[0],r=t[1],c=t[2],h=0,f=[];h<l.length;h++)s=l[h],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&f.push(n[s][0]),n[s]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);d&&d(t);while(f.length)f.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],o=!0,l=1;l<a.length;l++){var r=a[l];0!==n[r]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var o={},n={app:0},i=[];function s(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=o,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(a,o,function(t){return e[t]}.bind(null,o));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("Navbar"),a("v-main",{staticClass:"grey lighten-4"},[a("router-view")],1),a("Footer")],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("nav",[a("v-app-bar",{attrs:{flat:"",app:""}},[a("v-app-bar-nav-icon",{staticClass:"grey--text",on:{click:function(t){e.drawer=!e.drawer}}}),a("v-toolbar-title",{staticClass:"text-uppercase grey--text"},[a("span",[a("span",[e._v("Negative Caption ")]),a("span",{staticClass:"font-weight-light"},[e._v("Annotation")])])])],1)],1)},l=[],r={data:function(){return{drawer:!1,links:[{icon:"mdi-home",text:"Home",route:"/"}]}}},c=r,d=a("2877"),h=a("6544"),f=a.n(h),p=a("40dc"),u=a("5bc1"),v=a("2a7f"),m=Object(d["a"])(c,s,l,!1,null,null,null),g=m.exports;f()(m,{VAppBar:p["a"],VAppBarNavIcon:u["a"],VToolbarTitle:v["a"]});var I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-footer",{staticClass:"grey lighten-2",attrs:{app:"",padless:""}},[a("v-col",{staticClass:"text-center",attrs:{cols:"12"}},[e._v(" © "+e._s((new Date).getFullYear())+" — "),a("strong",[e._v("Negative Caption Annotation")])])],1)},x=[],b=a("62ad"),k=a("553a"),D={},w=Object(d["a"])(D,I,x,!1,null,null,null),y=w.exports;f()(w,{VCol:b["a"],VFooter:k["a"]});var S={name:"App",components:{Navbar:g,Footer:y},data:function(){return{}}},C=S,_=a("7496"),T=a("f6c4"),W=Object(d["a"])(C,n,i,!1,null,null,null),A=W.exports;f()(W,{VApp:_["a"],VMain:T["a"]});var P=a("8c4f"),V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("v-container",{staticClass:"my-5 d-flex flex-column justify-center"},[a("div",[a("v-row",{attrs:{justify:"center"}},[a("v-col",{attrs:{cols:"6"}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-text-field",{attrs:{rules:e.nameRules,label:"Name",required:""},on:{keyup:e.keyUp},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("v-text-field",{staticClass:"input-group--focused",attrs:{"append-icon":e.showPwd?"mdi-eye":"mdi-eye-off",rules:e.pwdRules,type:e.showPwd?"text":"password",name:"input-10-2",label:"Password"},on:{"click:append":function(t){e.showPwd=!e.showPwd},keyup:e.keyUp},model:{value:e.pwd,callback:function(t){e.pwd=t},expression:"pwd"}}),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.login}},[e._v(" Login ")])],1)],1)],1),a("v-snackbar",{attrs:{top:"",color:"red",text:""},scopedSlots:e._u([{key:"action",fn:function(t){var o=t.attrs;return[a("v-btn",e._b({attrs:{color:"pink",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",o,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(" "+e._s(e.errorMsg)+" ")])],1)])],1)},E=[],B=(a("b0c0"),a("bc3a")),M=a.n(B),L={data:function(){return{showPwd:!1,valid:!0,name:"",nameRules:[function(e){return!!e||"Name is required"}],pwd:"",pwdRules:[function(e){return!!e||"Password is required"}],snackbar:!1,errorMsg:""}},methods:{login:function(){var e=this;if(this.$refs.form.validate()){var t=new FormData;t.append("name",this.name),t.append("pwd",this.pwd),M.a.post(this.$api.BASE_URL+"auth",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){if(t.data["success"]){localStorage.setItem("name",t.data["name"]);var a=e.$route.query.redirect;a?e.$router.push(a):e.$router.push("/")}else e.errorMsg=t.data["error_msg"],e.snackbar=!0}))}},keyUp:function(e){13===e.keyCode&&this.login()}}},R=L,N=a("8336"),O=a("a523"),U=a("4bd4"),j=a("0fd9"),F=a("2db4"),$=a("8654"),Y=Object(d["a"])(R,V,E,!1,null,null,null),H=Y.exports;f()(Y,{VBtn:N["a"],VCol:b["a"],VContainer:O["a"],VForm:U["a"],VRow:j["a"],VSnackbar:F["a"],VTextField:$["a"]});var X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("div",{staticClass:"mx-4"},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-row",{staticClass:"mb-6"},[a("v-chip",{staticClass:"ml-3",attrs:{color:"cyan","text-color":"white"}},[e._v(" Annotator "),a("v-chip",{staticClass:"ml-2",attrs:{small:"",color:"cyan darken-3","text-color":"white"}},[e._v(" "+e._s(e.annotatorName)+" ")])],1),a("v-chip",{staticClass:"ml-3",attrs:{color:"deep-orange","text-color":"white"}},[e._v(" Images left "),a("v-chip",{staticClass:"ml-2",attrs:{small:"",color:"deep-orange darken-3","text-color":"white"}},[e._v(" "+e._s(e.leftImgNum)+" ")])],1),a("v-chip",{staticClass:"ml-3",attrs:{color:"green","text-color":"white"}},[e._v(" Images completed "),a("v-chip",{staticClass:"ml-2",attrs:{small:"",color:"green darken-3","text-color":"white"}},[e._v(" "+e._s(e.checkingImgNum)+" ")])],1),a("v-spacer"),a("v-btn",{staticClass:"mr-2",attrs:{depressed:"",dark:"",fab:"",small:"",color:"grey darken-2"},on:{click:e.clearRect}},[a("v-icon",[e._v("mdi-broom")])],1)],1),a("canvas",{attrs:{id:"canvas"}}),a("v-list",{staticClass:"grey lighten-4 mt-2",attrs:{rounded:"",id:"caption-list"}})],1),a("v-col",{attrs:{cols:"6"}},[a("v-row",{attrs:{justify:"end"}},[a("v-btn",{staticClass:"mx-2",attrs:{depressed:"",rounded:"",color:"primary"},on:{click:function(t){return e.saveData(!1)}}},[e._v(" Save "),a("v-icon",{attrs:{right:""}},[e._v("mdi-content-save")])],1),a("v-btn",{staticClass:"mx-2",attrs:{depressed:"",rounded:"",color:"primary"},on:{click:function(t){return e.saveData(!0)}}},[e._v(" Next "),a("v-icon",{attrs:{right:""}},[e._v("mdi-skip-next")])],1)],1),a("v-row",[a("div",{staticClass:"grey--text font-weight-light"},[e._v("Captions")])]),a("v-item-group",{attrs:{mandatory:"",value:e.capSelected}},[a("v-row",{staticStyle:{"margin-left":"-16px","margin-bottom":"12px"},attrs:{dense:""}},e._l(e.captions,(function(t,o){return a("v-col",{key:o,on:{click:function(t){return e.changeSelectedCap(o)}}},[a("v-item",{scopedSlots:e._u([{key:"default",fn:function(n){var i=n.active,s=n.toggle;return[a("v-card",{staticClass:"mx-auto caption-card",attrs:{color:i?"primary":"",outlined:""},on:{click:s}},[a("v-card-title",{staticClass:"text-subtitle-1 font-weight-thin"},[a("v-icon",{directives:[{name:"show",rawName:"v-show",value:e.completedState[o],expression:"completedState[i]"}],attrs:{dense:"",left:"",color:i?"green lighten-2":"green"}},[e._v("mdi-checkbox-marked-circle-outline")]),a("span",{class:i?"white--text":""},[e._v(e._s("Caption "+(o+1)))])],1),a("v-card-subtitle",{staticClass:"text-caption",class:i?"white--text":""},[e._v(" "+e._s(e.truncateCap(t))+" ")])],1)]}}],null,!0)})],1)})),1)],1),a("v-row",[a("v-textarea",{attrs:{filled:"","auto-grow":"",label:"Original Caption "+(e.capSelected+1),rows:"2",disabled:"",value:e.captions[e.capSelected]}})],1),a("v-row",[a("v-textarea",{attrs:{filled:"","auto-grow":"",label:"Modified Caption "+(e.capSelected+1),rows:"2",disabled:""},on:{input:function(t){return e.resetSelectedNegTokens(e.capSelected)}},model:{value:e.modifiedCaptions[e.capSelected],callback:function(t){e.$set(e.modifiedCaptions,e.capSelected,t)},expression:"modifiedCaptions[capSelected]"}})],1),a("v-row",[a("div",{staticClass:"grey--text font-weight-light"},[e._v("Tokens")])]),a("v-row",[0===e.tokensDetailInfo[e.capSelected].length||e.selectedDetailInfo["capIndex"]===e.capSelected&&0===e.selectedDetailInfo["tokenIndex"]?[a("v-chip",{staticClass:"mx-1 my-2",staticStyle:{"user-select":"text"},attrs:{outlined:"",color:"green lighten-2"},on:{click:e.showExtraDetailInfo}},[e._v(" Token "),a("v-icon",{attrs:{small:"",right:""}},[e._v("mdi-pencil-plus-outline")])],1),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.extraDetailInfo["selected"]&&e.extraDetailInfo["capIndex"]===e.capSelected,expression:"\n                extraDetailInfo['selected'] &&\n                extraDetailInfo['capIndex'] === capSelected\n              "}],staticClass:"mx-1 my-2"},[a("v-text-field",{staticStyle:{width:"100px"},on:{change:e.addTokenInFrontOfModifiedCap,blur:e.addTokenInFrontOfModifiedCap},model:{value:e.extraDetailInfo["inputValue"],callback:function(t){e.$set(e.extraDetailInfo,"inputValue",t)},expression:"extraDetailInfo['inputValue']"}})],1)]:e._e(),e._l(e.tokensDetailInfo[e.capSelected],(function(t,o){return[t["provideAlterWords"]?[e.varIsUndefined(t["tokenModifyTo"])?[a("v-badge",{key:e.capSelected+"-"+o,staticClass:"mx-1 my-2",attrs:{value:e.selectedDetailInfo["capIndex"]===e.capSelected&&e.selectedDetailInfo["tokenIndex"]===o,color:"grey lighten-4","offset-y":"9","offset-x":"10",left:"",overlap:""},scopedSlots:e._u([{key:"badge",fn:function(){return[a("v-icon",{staticStyle:{cursor:"pointer"},attrs:{small:"",color:"red lighten-1"},on:{click:function(t){return e.deleteTokenFromModifiedCap(e.capSelected,o)}}},[e._v(" mdi-close-circle-outline ")])]},proxy:!0}],null,!0)},[a("v-chip",{staticStyle:{"user-select":"text"},attrs:{link:"",color:"green lighten-2","text-color":"white"},on:{click:function(t){return e.showMoreDetailInfo(e.capSelected,o)}}},[e._v(" "+e._s(t["token"])+" ")])],1)]:[a("v-badge",{key:e.capSelected+"-"+o,staticClass:"mx-1 my-2",attrs:{value:e.selectedDetailInfo["capIndex"]==e.capSelected&&e.selectedDetailInfo["tokenIndex"]==o,color:"grey lighten-4","offset-y":"9","offset-x":"10",left:"",overlap:""},scopedSlots:e._u([{key:"badge",fn:function(){return[a("v-icon",{staticStyle:{cursor:"pointer"},attrs:{small:"",color:"red lighten-1"},on:{click:function(t){return e.deleteTokenFromModifiedCap(e.capSelected,o)}}},[e._v(" mdi-close-circle-outline ")])]},proxy:!0}],null,!0)},[a("v-chip",{staticStyle:{"border-color":"black","border-width":"1px","border-style":"dashed"},attrs:{outlined:""},on:{click:function(t){return e.showMoreDetailInfo(e.capSelected,o)}}},[a("v-chip",{staticStyle:{"user-select":"text"},attrs:{link:"",small:"",color:"green lighten-2","text-color":"white"}},[e._v(" "+e._s(t["token"])+" ")]),a("v-icon",[e._v(" mdi-arrow-right-thin ")]),a("v-chip",{staticStyle:{"user-select":"text"},attrs:{link:"",small:"",color:"red lighten-1","text-color":"white"}},[e._v(" "+e._s(t["alterWords"][t["tokenModifyTo"]])+" ")])],1)],1)]]:[a("v-badge",{key:e.capSelected+"-"+o,staticClass:"mx-1 my-2",attrs:{value:e.selectedDetailInfo["capIndex"]==e.capSelected&&e.selectedDetailInfo["tokenIndex"]==o,color:"grey lighten-4","offset-y":"9","offset-x":"10",left:"",overlap:""},scopedSlots:e._u([{key:"badge",fn:function(){return[a("v-icon",{staticStyle:{cursor:"pointer"},attrs:{small:"",color:"red lighten-1"},on:{click:function(t){return e.deleteTokenFromModifiedCap(e.capSelected,o)}}},[e._v(" mdi-close-circle-outline ")])]},proxy:!0}],null,!0)},[a("v-chip",{staticStyle:{"user-select":"text"},attrs:{link:"",color:t["changeToNeg"]?"red lighten-1":"","text-color":t["changeToNeg"]?"white":""},on:{click:function(t){return e.showMoreDetailInfo(e.capSelected,o)}}},[e._v(" "+e._s(t["token"])+" ")])],1)],e.varIsUndefined(e.selectedDetailInfo["tokenIndex"])||e.selectedDetailInfo["capIndex"]!=e.capSelected||e.selectedDetailInfo["tokenIndex"]!=o?e._e():[a("v-icon",{directives:[{name:"show",rawName:"v-show",value:!e.selectedDetailInfo["inputToken"],expression:"!selectedDetailInfo['inputToken']"}],key:"icon"+e.capSelected+"-"+o,attrs:{small:""},on:{click:function(t){e.selectedDetailInfo["inputToken"]=!0}}},[e._v("mdi-plus-circle-outline")]),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.selectedDetailInfo["inputToken"],expression:"selectedDetailInfo['inputToken']"}],key:"input"+e.capSelected+"-"+o,staticClass:"mx-1 my-2"},[a("v-text-field",{staticStyle:{width:"100px"},on:{change:e.addTokenToModifiedCap,blur:e.addTokenToModifiedCap},model:{value:e.selectedDetailInfo["inputValue"],callback:function(t){e.$set(e.selectedDetailInfo,"inputValue",t)},expression:"selectedDetailInfo['inputValue']"}})],1)]]}))],2),!e.varIsUndefined(e.selectedDetailInfo["tokenIndex"])&&e.selectedDetailInfo["capIndex"]==e.capSelected&&e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["provideAlterWords"]?[a("v-row",{staticClass:"mt-1"},[a("div",{staticClass:"grey--text font-weight-light"},[e._v(" Alternative Words of "),a("v-chip",{attrs:{small:"",outlined:"",color:"green lighten-2"}},[e._v(e._s(e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["token"]))])],1)]),a("v-row",{staticClass:"mb-3"},[e._l(e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["alterWords"],(function(t,o){return a("v-chip",{key:o,staticClass:"ma-1",class:e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["tokenModifyTo"]===o?"red--text":"",staticStyle:{"user-select":"text"},attrs:{color:e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["tokenModifyTo"]===o?"red lighten-4":""},on:{click:function(t){return e.changeAlterWord(o)}}},[e._v(" "+e._s(t)+" ")])})),a("v-chip",{staticClass:"ma-1",staticStyle:{"user-select":"text"},attrs:{outlined:"",color:"green lighten-2"},on:{click:function(t){return e.showAddAlterWordsDetailInfo(e.selectedDetailInfo["tokenIndex"])}}},[e._v(" Token "),a("v-icon",{attrs:{small:"",right:""}},[e._v("mdi-pencil-plus-outline")])],1),a("v-chip",{directives:[{name:"show",rawName:"v-show",value:e.addAlterWordsDetailInfo["selected"]&&e.addAlterWordsDetailInfo["capIndex"]===e.capSelected,expression:"\n                addAlterWordsDetailInfo['selected'] &&\n                addAlterWordsDetailInfo['capIndex'] === capSelected\n              "}],staticClass:"ma-1"},[a("v-text-field",{staticStyle:{width:"100px"},on:{change:e.addTokenToAlterWords,blur:e.addTokenToAlterWords},model:{value:e.addAlterWordsDetailInfo["inputValue"],callback:function(t){e.$set(e.addAlterWordsDetailInfo,"inputValue",t)},expression:"addAlterWordsDetailInfo['inputValue']"}})],1)],2)]:e.varIsUndefined(e.selectedDetailInfo["tokenIndex"])||e.selectedDetailInfo["capIndex"]!=e.capSelected||e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["provideAlterWords"]?[a("v-row",{staticClass:"mb-3"})]:[a("v-row",{staticClass:"mt-1"},[a("div",{staticClass:"grey--text font-weight-light"},[e._v(" Change the State of the Selected Token ")])]),a("v-row",[a("v-switch",{attrs:{color:"red",label:e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["changeToNeg"]?"Negative":"Positive"},model:{value:e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]]["changeToNeg"],callback:function(t){e.$set(e.tokensDetailInfo[e.selectedDetailInfo["capIndex"]][e.selectedDetailInfo["tokenIndex"]],"changeToNeg",t)},expression:"\n                tokensDetailInfo[selectedDetailInfo['capIndex']][\n                  selectedDetailInfo['tokenIndex']\n                ]['changeToNeg']\n              "}})],1)],a("hr",{staticStyle:{"border-style":"dashed"},attrs:{size:"1"}}),a("v-row",[a("div",{staticClass:"grey--text font-weight-light mt-3"},[e._v("Error Type")])]),a("v-row",[a("v-radio-group",{staticClass:"ma-0",attrs:{row:""},model:{value:e.errorSelected[e.capSelected],callback:function(t){e.$set(e.errorSelected,e.capSelected,t)},expression:"errorSelected[capSelected]"}},e._l(e.errorItems,(function(e,t){return a("v-radio",{key:t,attrs:{label:e,value:e}})})),1)],1),a("v-row",[a("div",{staticClass:"grey--text font-weight-light"},[e._v("Completed State")])]),a("v-row",[a("v-switch",{staticClass:"ma-0",attrs:{inset:"",label:e.completedState[e.capSelected]?"Completed":"Uncompleted"},model:{value:e.completedState[e.capSelected],callback:function(t){e.$set(e.completedState,e.capSelected,t)},expression:"completedState[capSelected]"}})],1)],2)],1),a("v-snackbar",{attrs:{top:"",timeout:"3000"},scopedSlots:e._u([{key:"action",fn:function(t){var o=t.attrs;return[a("v-btn",e._b({attrs:{text:"",color:"pink"},on:{click:function(t){e.promptSnackbar=!1}}},"v-btn",o,!1),[e._v(" Close ")])]}}]),model:{value:e.promptSnackbar,callback:function(t){e.promptSnackbar=t},expression:"promptSnackbar"}},[e._v(" "+e._s(e.prompt)+" ")])],1)])},q=[],z=(a("4160"),a("c975"),a("fb6a"),a("a434"),a("ac1f"),a("5319"),a("1276"),a("498a"),a("159b"),a("b85c")),G={data:function(){return{annotatorName:"",leftImgNum:0,checkingImgNum:0,errorItems:["Entity Error","Attribute Error(Modifier)","Attribute Error(Action)","Attribute Error(Position)"],errorSelected:["Entity Error"],completedState:[!1],promptSnackbar:!1,prompt:"",imgName:"",imgUrl:"",captions:["Good luck to anyone who reads this."],modifiedCaptions:["Good luck to anyone who reads this."],capTokens:[null],capSelected:0,imgWidth:0,imgHeight:0,canvasWidth:0,canvasHeight:0,capCardHeight:0,img:new Image,mouseDown:!1,bboxTopLeftPoint:{},bboxBottomRightPoint:{},bboxes:[[]],tokensDetailInfo:[[]],selectedDetailInfo:{capIndex:void 0,tokenIndex:void 0,inputToken:!1,inputValue:""},extraDetailInfo:{capIndex:void 0,selected:!1,inputValue:""},addAlterWordsDetailInfo:{capIndex:void 0,tokenIndex:void 0,selected:!1,inputValue:""}}},watch:{canvasWidth:function(){this.canvasHeight=this.canvasWidth/this.imgWidth*this.imgHeight;var e=document.getElementById("canvas"),t=e.getContext("2d");e.width=this.canvasWidth,e.height=this.canvasHeight,t.drawImage(this.img,0,0,this.canvasWidth,this.canvasHeight),t.strokeStyle="red",t.lineWidth=1;var a,o=Object(z["a"])(this.currentBboxes);try{for(o.s();!(a=o.n()).done;){var n=a.value;t.strokeRect(n["bboxTopLeftPoint"].relativeX*e.width,n["bboxTopLeftPoint"].relativeY*e.height,n["bboxBottomRightPoint"].relativeX*e.width-n["bboxTopLeftPoint"].relativeX*e.width,n["bboxBottomRightPoint"].relativeY*e.height-n["bboxTopLeftPoint"].relativeY*e.height)}}catch(i){o.e(i)}finally{o.f()}this.resetCapCardsHeight()},bboxBottomRightPoint:function(){var e=document.getElementById("canvas"),t=e.getContext("2d");t.drawImage(this.img,0,0,this.canvasWidth,this.canvasHeight),t.strokeStyle="red",t.lineWidth=1;var a,o=Object(z["a"])(this.currentBboxes);try{for(o.s();!(a=o.n()).done;){var n=a.value;t.strokeRect(n["bboxTopLeftPoint"].relativeX*e.width,n["bboxTopLeftPoint"].relativeY*e.height,n["bboxBottomRightPoint"].relativeX*e.width-n["bboxTopLeftPoint"].relativeX*e.width,n["bboxBottomRightPoint"].relativeY*e.height-n["bboxTopLeftPoint"].relativeY*e.height)}}catch(i){o.e(i)}finally{o.f()}t.strokeRect(this.bboxTopLeftPoint.relativeX*e.width,this.bboxTopLeftPoint.relativeY*e.height,this.bboxBottomRightPoint.relativeX*e.width-this.bboxTopLeftPoint.relativeX*e.width,this.bboxBottomRightPoint.relativeY*e.height-this.bboxTopLeftPoint.relativeY*e.height)},imgUrl:function(){var e=document.getElementById("canvas"),t=e.getContext("2d"),a=new Image,o=this;a.onload=function(){o.imgWidth=this.width,o.imgHeight=this.height,o.canvasHeight=o.canvasWidth/this.width*this.height,e.width=o.canvasWidth,e.height=o.canvasHeight,o.img=this,t.drawImage(this,0,0,o.canvasWidth,o.canvasHeight)},a.src=this.imgUrl},img:function(){var e=document.getElementById("canvas"),t=e.getContext("2d");t.drawImage(this.img,0,0,this.canvasWidth,this.canvasHeight),t.strokeStyle="red",t.lineWidth=1;var a,o=Object(z["a"])(this.currentBboxes);try{for(o.s();!(a=o.n()).done;){var n=a.value;t.strokeRect(n["bboxTopLeftPoint"].relativeX*e.width,n["bboxTopLeftPoint"].relativeY*e.height,n["bboxBottomRightPoint"].relativeX*e.width-n["bboxTopLeftPoint"].relativeX*e.width,n["bboxBottomRightPoint"].relativeY*e.height-n["bboxTopLeftPoint"].relativeY*e.height)}}catch(i){o.e(i)}finally{o.f()}},currentBboxes:function(){var e=document.getElementById("canvas"),t=e.getContext("2d");t.drawImage(this.img,0,0,this.canvasWidth,this.canvasHeight),t.strokeStyle="red",t.lineWidth=1;var a,o=Object(z["a"])(this.currentBboxes);try{for(o.s();!(a=o.n()).done;){var n=a.value;t.strokeRect(n["bboxTopLeftPoint"].relativeX*e.width,n["bboxTopLeftPoint"].relativeY*e.height,n["bboxBottomRightPoint"].relativeX*e.width-n["bboxTopLeftPoint"].relativeX*e.width,n["bboxBottomRightPoint"].relativeY*e.height-n["bboxTopLeftPoint"].relativeY*e.height)}}catch(i){o.e(i)}finally{o.f()}}},computed:{currentBboxes:function(){return this.bboxes[this.capSelected]}},mounted:function(){var e=this;window.onresize=function(){return function(){e.canvasWidth=document.getElementById("caption-list").clientWidth}()},this.canvasWidth=document.getElementById("caption-list").clientWidth;var t=function(e,t){var a=e.getBoundingClientRect(),o=t.clientX-a.left*(e.width/a.width),n=t.clientY-a.top*(e.height/a.height),i=o/e.width,s=n/e.height;return{relativeX:i,relativeY:s}},a=this,o=document.getElementById("canvas");o.addEventListener("mousedown",(function(e){a.bboxTopLeftPoint=t(o,e),a.mouseDown=!0})),o.addEventListener("mousemove",(function(e){var n=t(o,e);a.mouseDown&&n.relativeX*o.width>a.bboxTopLeftPoint.relativeX*o.width&&n.relativeY*o.height>a.bboxTopLeftPoint.relativeY*o.height&&(a.bboxBottomRightPoint=n)})),o.addEventListener("mouseup",(function(e){a.mouseDown=!1;var n=t(o,e);n.relativeX*o.width>a.bboxTopLeftPoint.relativeX*o.width&&n.relativeY*o.height>a.bboxTopLeftPoint.relativeY*o.height&&(a.bboxBottomRightPoint=n,a.bboxes[a.capSelected].push({bboxTopLeftPoint:a.bboxTopLeftPoint,bboxBottomRightPoint:a.bboxBottomRightPoint}))})),this.getData()},methods:{getData:function(){var e=this,t=localStorage.getItem("name");M.a.get(this.$api.BASE_URL+"img-caps-pair?name="+t).then((function(t){t.data["success"]&&(e.imgName=t.data["annotation_data"]["img"],e.imgUrl=t.data["annotation_data"]["img_url"],e.captions=t.data["annotation_data"]["caps"],e.annotatorName=t.data["annotation_data"]["name"],e.leftImgNum=t.data["annotation_data"]["left_img_num"],e.checkingImgNum=t.data["annotation_data"]["checking_img_num"],t.data["annotation_data"]["restore_data"]?(e.modifiedCaptions=t.data["annotation_data"]["modifiedCaptions"],e.errorSelected=t.data["annotation_data"]["errorSelected"],e.completedState=t.data["annotation_data"]["completedState"],e.capTokens=t.data["annotation_data"]["capTokens"],e.tokensDetailInfo=t.data["annotation_data"]["tokensDetailInfo"],e.bboxes=t.data["annotation_data"]["bboxes"]):(e.modifiedCaptions=t.data["annotation_data"]["caps"].slice(0),e.errorSelected=[],e.completedState=[],e.capTokens=[],e.tokensDetailInfo=[],e.bboxes=[],e.captions.forEach((function(t,a){e.errorSelected.push("Entity Error"),e.completedState.push(!1),e.capTokens.push(null),e.tokensDetailInfo.push([]),e.bboxes.push([]),M.a.get(e.$api.BASE_URL+"tokenization?sentence="+t).then((function(t){e.capTokens[a]=t.data["tokens"]})).then((function(){e.capTokens[a].forEach((function(t){var o={};o["token"]=t,o["tokenModifyTo"]=void 0,o["provideAlterWords"]=!1,o["changeToNeg"]=!1,o["alterWords"]=[],e.tokensDetailInfo[a].push(o)}))})).then((function(){M.a.get(e.$api.BASE_URL+"similar-substantive-tokens?sentence="+t).then((function(t){t.data["similar_tokens_info"].forEach((function(t){e.tokensDetailInfo[a][t["token_pos"]]["provideAlterWords"]=!0,e.tokensDetailInfo[a][t["token_pos"]]["alterWords"]=t["similar_tokens"]}))}))}))}))))})).then((function(){e.resetCapCardsHeight()}))},saveData:function(e){var t=this;if(e&&this.completedState.indexOf(!1)>=0)return this.promptSnackbar=!0,void(this.prompt="Please save after you have accomplished all the caption annotations!");var a=localStorage.getItem("name"),o={name:a,img:this.imgName,errorSelected:this.errorSelected,modifiedCaptions:this.modifiedCaptions,capTokens:this.capTokens,completedState:this.completedState,bboxes:this.bboxes,tokensDetailInfo:this.tokensDetailInfo};M.a.post(this.$api.BASE_URL+"checking-annotation-data",{data:o,next:e}).then((function(e){e.data["success"]&&(t.promptSnackbar=!0,t.prompt=e.data["msg"])})).then((function(){e&&(t.resetPageData(),t.getData())}))},resetCapCardsHeight:function(){for(var e=document.getElementsByClassName("caption-card"),t=0,a=0;a<e.length;a++)e[a].style.height="",t=e[a].offsetHeight>t?e[a].offsetHeight:t;for(var o=0;o<e.length;o++)e[o].style.height=t+"px"},changeSelectedCap:function(e){this.capSelected=e},draw:function(){var e=document.getElementById("canvas").getContext("2d");e.strokeStyle="red",e.lineWidth=1,e.strokeRect(10,10,100,100)},clearRect:function(){this.bboxes[this.capSelected].splice(0)},varIsUndefined:function(e){return"undefined"===typeof e},truncateCap:function(e){return e.length>60&&(e=e.substring(0,60)+"..."),e},showMoreDetailInfo:function(e,t){this.selectedDetailInfo["capIndex"]===e&&this.selectedDetailInfo["tokenIndex"]===t?(0===t&&this.resetExtraDetailInfo(),this.selectedDetailInfo["capIndex"]=void 0,this.selectedDetailInfo["tokenIndex"]=void 0):(this.selectedDetailInfo["capIndex"]=e,this.selectedDetailInfo["tokenIndex"]=t),this.resetSelectedDetailInfo(!1)},showExtraDetailInfo:function(){this.extraDetailInfo["capIndex"]!==this.capSelected?(this.resetExtraDetailInfo(),this.extraDetailInfo["capIndex"]=this.capSelected,this.extraDetailInfo["selected"]=!0):this.extraDetailInfo["selected"]?this.resetExtraDetailInfo():this.extraDetailInfo["selected"]=!0},showAddAlterWordsDetailInfo:function(e){this.addAlterWordsDetailInfo["capIndex"]!==this.capSelected?(this.resetAddAlterWordsDetailInfo(),this.addAlterWordsDetailInfo["capIndex"]=this.capSelected,this.addAlterWordsDetailInfo["tokenIndex"]=e,this.addAlterWordsDetailInfo["selected"]=!0):this.addAlterWordsDetailInfo["selected"]?this.resetAddAlterWordsDetailInfo():this.addAlterWordsDetailInfo["selected"]=!0},changeAlterWord:function(e){this.resetAddAlterWordsDetailInfo();var t=this.selectedDetailInfo["capIndex"],a=this.selectedDetailInfo["tokenIndex"];this.tokensDetailInfo[t][a]["tokenModifyTo"]===e?(this.updateModifiedCap(void 0),this.tokensDetailInfo[t][a]["tokenModifyTo"]=void 0):(this.updateModifiedCap(e),this.tokensDetailInfo[t][a]["tokenModifyTo"]=e)},updateModifiedCap:function(e){for(var t=this.selectedDetailInfo["capIndex"],a=this.selectedDetailInfo["tokenIndex"],o=this.tokensDetailInfo[t],n=this.modifiedCaptions[this.capSelected],i=o[a]["tokenModifyTo"],s=0,l=0;l<a;l++){while(" "===n[s])s++;if(o[l]["provideAlterWords"]){var r=o[l]["tokenModifyTo"];this.varIsUndefined(r)?s+=o[l]["token"].length:s+=o[l]["alterWords"][r].length}else s+=o[l]["token"].length}while(" "===n[s])s++;if(this.varIsUndefined(e)){var c=o[a]["alterWords"][i],d=o[a]["token"];this.modifiedCaptions[this.capSelected]=n.substring(0,s)+d+n.substring(s+c.length,n.length)}else{var h=o[a]["token"];this.varIsUndefined(i)||(h=o[a]["alterWords"][i]);var f=o[a]["alterWords"][e];this.modifiedCaptions[this.capSelected]=n.substring(0,s)+f+n.substring(s+h.length,n.length)}this.$forceUpdate()},addTokenToModifiedCap:function(){var e=this.selectedDetailInfo["inputValue"].trim().replace(/\s+/gm," ");if(""!==e){var t,a=e.split(" ").reverse(),o=Object(z["a"])(a);try{for(o.s();!(t=o.n()).done;){var n=t.value,i={};i["token"]=n,i["tokenModifyTo"]=void 0,i["provideAlterWords"]=!1,i["alterWords"]=[],this.tokensDetailInfo[this.selectedDetailInfo["capIndex"]].splice(this.selectedDetailInfo["tokenIndex"]+1,0,i)}}catch(u){o.e(u)}finally{o.f()}this.resetSelectedDetailInfo(!1);for(var s=this.selectedDetailInfo["capIndex"],l=this.selectedDetailInfo["tokenIndex"],r=this.tokensDetailInfo[s],c=this.modifiedCaptions[this.capSelected],d=0,h=0;h<=l;h++){while(" "===c[d])d++;if(r[h]["provideAlterWords"]){var f=r[h]["tokenModifyTo"];this.varIsUndefined(f)?d+=r[h]["token"].length:d+=r[h]["alterWords"][f].length}else d+=r[h]["token"].length}while(" "===c[d])d++;var p=e;this.modifiedCaptions[this.capSelected]=c.substring(0,d)+p+" "+c.substring(d,c.length),this.resetSelectedDetailInfo(!0)}else this.resetSelectedDetailInfo(!0)},addTokenInFrontOfModifiedCap:function(){var e=this.extraDetailInfo["inputValue"].trim().replace(/\s+/gm," ");if(""===e)return this.resetExtraDetailInfo(),void this.resetSelectedDetailInfo(!0);var t,a=e.split(" ").reverse(),o=Object(z["a"])(a);try{for(o.s();!(t=o.n()).done;){var n=t.value,i={};i["token"]=n,i["tokenModifyTo"]=void 0,i["provideAlterWords"]=!1,i["alterWords"]=[],0===this.tokensDetailInfo[this.capSelected].length?this.tokensDetailInfo[this.capSelected].push(i):this.tokensDetailInfo[this.capSelected].splice(0,0,i)}}catch(r){o.e(r)}finally{o.f()}var s=0,l=this.modifiedCaptions[this.capSelected];while(" "===l[s])s++;this.modifiedCaptions[this.capSelected]=e+" "+l.substring(s),this.resetExtraDetailInfo(),this.resetSelectedDetailInfo(!0)},addTokenToAlterWords:function(){var e=this.addAlterWordsDetailInfo["inputValue"].trim().replace(/\s+/gm," ");if(""!==e){var t,a=e.split(" "),o=Object(z["a"])(a);try{for(o.s();!(t=o.n()).done;){var n=t.value;this.tokensDetailInfo[this.capSelected][this.addAlterWordsDetailInfo["tokenIndex"]]["alterWords"].push(n)}}catch(i){o.e(i)}finally{o.f()}this.resetAddAlterWordsDetailInfo()}else this.resetAddAlterWordsDetailInfo()},deleteTokenFromModifiedCap:function(e,t){for(var a=this.tokensDetailInfo[e],o=this.modifiedCaptions[this.capSelected],n=0,i=0;i<t;i++){while(" "===o[n])n++;if(a[i]["provideAlterWords"]){var s=a[i]["tokenModifyTo"];this.varIsUndefined(s)?n+=a[i]["token"].length:n+=a[i]["alterWords"][s].length}else n+=a[i]["token"].length}var l=n;while(" "===o[l])l++;this.varIsUndefined(a[t]["tokenModifyTo"])?l+=a[t]["token"].length:l+=a[t]["alterWords"][a[t]["tokenModifyTo"]].length;while(" "===o[l])l++;this.resetSelectedDetailInfo(!0),0===t&&this.resetExtraDetailInfo();var r="";n&&(r=" "),this.modifiedCaptions[this.capSelected]=o.substring(0,n)+r+o.substring(l,o.length),this.tokensDetailInfo[e].splice(t,1)},resetSelectedDetailInfo:function(e){e?(this.selectedDetailInfo["capIndex"]=void 0,this.selectedDetailInfo["tokenIndex"]=void 0,this.selectedDetailInfo["inputToken"]=!1,this.selectedDetailInfo["inputValue"]=""):(this.selectedDetailInfo["inputToken"]=!1,this.selectedDetailInfo["inputValue"]="")},resetExtraDetailInfo:function(){this.extraDetailInfo["capIndex"]=void 0,this.extraDetailInfo["selected"]=!1,this.extraDetailInfo["inputValue"]=""},resetAddAlterWordsDetailInfo:function(){this.addAlterWordsDetailInfo["capIndex"]=void 0,this.addAlterWordsDetailInfo["tokenIndex"]=void 0,this.addAlterWordsDetailInfo["selected"]=!1,this.addAlterWordsDetailInfo["inputValue"]=""},resetPageData:function(){this.capSelected=0,this.resetSelectedDetailInfo(!0),this.resetExtraDetailInfo(),this.resetAddAlterWordsDetailInfo()},testFunction:function(){console.log("wuhu")}}},J=G,K=a("4ca6"),Q=a("b0af"),Z=a("99d9"),ee=a("cc20"),te=a("132d"),ae=a("d903"),oe=a("604c"),ne=a("8860"),ie=a("67b6"),se=a("43a6"),le=a("2fa4"),re=a("b73d"),ce=a("a844"),de=Object(d["a"])(J,X,q,!1,null,null,null),he=de.exports;f()(de,{VBadge:K["a"],VBtn:N["a"],VCard:Q["a"],VCardSubtitle:Z["a"],VCardTitle:Z["b"],VChip:ee["a"],VCol:b["a"],VIcon:te["a"],VItem:ae["a"],VItemGroup:oe["b"],VList:ne["a"],VRadio:ie["a"],VRadioGroup:se["a"],VRow:j["a"],VSnackbar:F["a"],VSpacer:le["a"],VSwitch:re["a"],VTextField:$["a"],VTextarea:ce["a"]}),o["a"].use(P["a"]);var fe=[{path:"/",name:"Home",component:he,meta:{login:!0}},{path:"/login",name:"Login",component:H},{path:"*",component:he,meta:{login:!0}}],pe=new P["a"]({mode:"history",base:"",routes:fe});pe.beforeEach((function(e,t,a){var o=localStorage.getItem("name");null===o&&e.meta.login?a({name:"Login",query:{redirect:e.fullPath}}):a()}));var ue=pe,ve=a("f309");o["a"].use(ve["a"]);var me=new ve["a"]({icons:{iconfont:"mdi"},theme:{themes:{light:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}});o["a"].config.productionTip=!1,o["a"].prototype.$api=a("7c15"),new o["a"]({router:ue,vuetify:me,render:function(e){return e(A)}}).$mount("#app")},"7c15":function(e,t,a){"use strict";a.r(t),a.d(t,"BASE_URL",(function(){return o}));var o="https://marswhu.tk:8000/"}});
//# sourceMappingURL=app.2834b6ac.js.map